{"info":{"_postman_id":"897a2ffb-e00a-47be-bb37-803cb74c456a","name":"BokaPaketLeverans","schema":"https://schema.getpostman.com/json/collection/v2.1.0/collection.json"},"item":[{"name":"Autentisering","event":[{"listen":"test","script":{"id":"99af8f9e-ca31-4fd6-9e83-6531fc06e2b3","exec":["pm.test(\"Status code is 200\", function () {\r","    pm.response.to.have.status(200);\r","});\r","\r","pm.test(\"Token is present\", function () {\r","    pm.response.to.have.header(\"token\");\r","});\r","\r","var response = pm.response.json();\r","console.log(response)\r","if (pm.response.code === 200) {   \r","    var accessToken = response.token;   \r","    pm.environment.set(\"access_token\", accessToken);\r","} else {   \r","    console.error(\"Error Status Code:\", response.statusCode);    \r","    console.error(\"Error Map:\", response.errorMap.key);\r","    console.error(\"Error Tracking Nr:\", response.errorTrackingNr);\r","    console.error(\"Error Message:\", response.errorMessage);\r","}"],"type":"text/javascript"}},{"listen":"prerequest","script":{"id":"fe03fc08-0ce5-4bd5-9bce-ac7c5139169a","exec":["console.clear();"],"type":"text/javascript"}}],"id":"2f7cdcf0-d10d-4844-9656-c60bb3f43162","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"method":"POST","header":[],"body":{"mode":"raw","raw":"{\r\n    \"username\": {{username}},\r\n    \"password\": \"{{secret}}\"\r\n}","options":{"raw":{"language":"json"}}},"url":{"raw":"{{base_url}}/auth/token","host":["{{base_url}}"],"path":["auth","token"]}},"response":[]},{"name":"KollaLeverans","event":[{"listen":"prerequest","script":{"id":"30454bb0-c43c-490d-b9e3-fc371fa32ab6","exec":["console.clear();"],"type":"text/javascript"}},{"listen":"test","script":{"id":"8c5e0e06-cf11-42c8-ad24-7a2432eb91d3","exec":["var responseBody = pm.response.json();\r","\r","pm.test(\"Early bird can perform delivery to requested address\", function () {\r","    pm.response.to.have.status(200);\r","});\r","\r","pm.test(\"productId is provided\", function () {\r","    pm.expect(responseBody).to.have.property(\"productId\");\r","    });\r","pm.test(\"productId is a string\", function () {\r","    pm.expect(responseBody.productId).to.be.a(\"string\");\r","});\r","\r","pm.test(\"productId is one of the allowed values\", function () {\r","    var allowedProductIds = [\r","        \"ica.servicepoint\",\r","        \"express\",\r","        \"home\",\r","        \"return\",\r","        \"c2c-home\",\r","        \"servicepoint\",\r","        \"postnord.mypack\",\r","        \"postnord.varubrev\",\r","        \"postnord.varubrev-1a\",\r","        \"box\"\r","    ];\r","    pm.expect(allowedProductIds).to.include(responseBody.productId);\r","});\r","\r","var productId = response.productId;   \r","pm.environment.set(\"product_Id\", productId);\r","\r","pm.test(\"Fallback option is provided\", function () {\r","    pm.expect(responseBody).to.have.property(\"fallback\");\r","});\r","\r","pm.test(\"Fallback is a boolean\", function () {\r","    pm.expect(responseBody.fallback).to.be.a(\"boolean\");\r","});\r","\r","\r","pm.test(\"Delivery method based on productId\", function () {\r","    if (responseBody.productId === \"home\") {\r","        pm.expect(responseBody).to.have.property(\"deliveryMethod\", \"standard home package\");\r","    } else {\r","        pm.expect(responseBody).to.have.property(\"deliveryMethod\", \"alternative delivery method\");\r","    }\r","});\r","pm.test(\"Delivery method based on productId\", function () {\r","    if (responseBody.productId === \"home\") {\r","        pm.expect(responseBody).to.not.have.property(\"fallback\"); // Ensure fallback is not present for \"home\" productId\r","    } else {\r","        pm.expect(responseBody).to.have.property(\"fallback\", true); // Ensure fallback is present and set to true for non-\"home\" productId\r","    }\r","});\r","\r",""],"type":"text/javascript"}}],"id":"e9786b22-ccf3-4d1b-be28-b7f5e1b5bc23","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"auth":{"type":"oauth2","oauth2":[{"key":"addTokenTo","value":"header","type":"string"}]},"method":"POST","header":[{"key":"Content-Type","value":"application/json","type":"text"}],"body":{"mode":"raw","raw":"{\r\n    \"desiredDeliveryDate\": \"{{delivery-date}}\",\r\n    \"country\": \"{{delivery-country}}\",\r\n    \"zip\": \"{{delivery-zip}}\",\r\n    \"city\": \"{{delivery_city}}\",\r\n    \"address\": \"{{delivery_adress}}\",\r\n    \"volume\": {{delivery-volume}},\r\n    \"weight\": {{delivery-weight}}\r\n}","options":{"raw":{"language":"json"}}},"url":{"raw":"{{base_url}}/v1/check/:productId","host":["{{base_url}}"],"path":["v1","check",":productId"],"variable":[{"key":"productId","value":"home"}]}},"response":[]},{"name":"BokaLeverans","event":[{"listen":"prerequest","script":{"id":"7f48e3eb-10d0-4038-8b37-2fa720e29556","exec":["var order_Id=pm.variables.replaceIn('{{$randomAlphaNumeric}}');\r","pm.environment.set(\"order_ID\", \"order_Id\");"],"type":"text/javascript"}},{"listen":"test","script":{"id":"fa77ad09-0aaa-404c-bb91-84c883c936ac","exec":["var responseBody = pm.response.json();\r","\r","pm.test(\"Status code is 200\", function () {\r","    pm.response.to.have.status(200);\r","});\r","\r","pm.test(\"Response body is in JSON format\", function () {\r","    pm.response.to.be.json;\r","});\r","\r","pm.test(\"Response contains orderId\", function () {\r","    pm.expect(responseBody).to.have.property(\"orderId\");\r","});\r","\r","pm.test(\"Response contains trackingCode\", function () {\r","    pm.expect(responseBody).to.have.property(\"trackingCode\");\r","});\r","\r","var trackingCode = responseBody.trackingCode;\r","\r","pm.environment.set(\"tracking_ID\", trackingCode);\r","\r","pm.test(\"Response contains deliveries array\", function () {\r","    pm.expect(responseBody).to.have.property(\"deliveries\").that.is.an(\"array\");\r","});\r","\r","pm.test(\"Each delivery in deliveries array has required properties\", function () {\r","    pm.expect(responseBody.deliveries).to.be.an(\"array\").and.to.have.lengthOf.at.least(1);\r","    responseBody.deliveries.forEach(function(delivery) {\r","        pm.expect(delivery).to.have.property(\"deliveryId\");\r","        pm.expect(delivery).to.have.property(\"productId\");\r","        pm.expect(delivery).to.have.property(\"trackingId\");\r","        pm.expect(delivery).to.have.property(\"deliveryDay\");\r","        pm.expect(delivery).to.have.property(\"returnCode\");\r","        pm.expect(delivery).to.have.property(\"attributes\");\r","        pm.expect(delivery).to.have.property(\"latestDeliveryDate\");\r","        pm.expect(delivery).to.have.property(\"earliestDeliveryDate\");\r","        pm.expect(delivery).to.have.property(\"label\");\r","\r","    });\r","});\r",""],"type":"text/javascript"}}],"id":"e4f1ee3f-950f-413c-a714-545b5a7bf3a4","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"auth":{"type":"oauth2","oauth2":[{"key":"addTokenTo","value":"header","type":"string"}]},"method":"POST","header":[{"key":"Content-Type","value":"application/json","type":"text"}],"body":{"mode":"raw","raw":"{\r\n    \"orderId\": \"{{order_ID}}\",\r\n    \"productId\": \"{{product_Id}}\",\r\n    \"sender\": {\r\n        \"name\": \"{{$randomCompanyName}}\",\r\n        \"address\": \"{{$randomStreetAddress}}\",\r\n        \"zip\": \"19255\",\r\n        \"city\": \"{{$randomCity}}\",\r\n        \"email\": \"{{$randomEmail}}\",\r\n        \"phone\": \"{{$randomPhoneNumber}}\",        \r\n        \"country\": \"SE\",\r\n        \"reference\": \"{{$randomAlphaNumeric}}\",\r\n        \"contact\": \"{{$randomFullName}}\"\r\n    },\r\n    \"receiver\": {\r\n        \"name\": \"{{$randomFullName}}\",\r\n        \"address\": \"{{delivery_adress}}\",\r\n        \"co\": \"{{$randomLastName}}\",\r\n        \"zip\": \"{{delivery-zip}}\",\r\n        \"city\": \"{{delivery_city}}\",\r\n        \"email\": \"{{$randomEmail}}\",\r\n        \"phone\": \"{{$randomPhoneNumber}}\",\r\n        \"country\": \"{{delivery-country}}\",\r\n        \"reference\": \"{{$randomAlphaNumeric}}\",\r\n        \"contact\": \"{{$randomFullName}}\"\r\n    },\r\n    \"parcels\": {\r\n            \"desc\": \"Parcel 1\",\r\n            \"weight\": {{delivery-weight}},\r\n            \"volume\": {{delivery-volume}},\r\n            \"width\": 10,\r\n            \"height\": 20,\r\n            \"length\": 30,\r\n            \"value\": 50            \r\n            },\r\n   \"attributes\": {\r\n            \"key\": \"False\"                   \r\n            },\r\n    \"deliveryDay\": \"{{delivery-date}}\"\r\n        }\r\n\r\n","options":{"raw":{"language":"json"}}},"url":{"raw":"{{base_url}}/v1/orders","host":["{{base_url}}"],"path":["v1","orders"]}},"response":[]},{"name":"KollaStatus","event":[{"listen":"test","script":{"id":"ff3c0a27-8891-401a-8aaa-4d9170ed7025","exec":["pm.test(\"Status code is 200\", function () {\r","    pm.response.to.have.status(200);\r","});\r","\r","pm.test(\"Response body is in JSON format\", function () {\r","    pm.response.to.be.json;\r","});\r","\r","pm.test(\"Response contains orderId\", function () {\r","    pm.expect(pm.response.json()).to.have.property(\"orderId\");\r","    });\r","\r","pm.test(\"Verify order ID\", function () {\r","    var expectedOrderID=pm.collectionVariables.get(\"order_ID\");\r","    var jsonData = pm.response.json();\r","    pm.expect(jsonData.orderId).to.eql(expectedOrderID);\r","\r","});\r","pm.test(\"Response contains deliveries array\", function () {\r","    pm.expect(pm.response.json()).to.have.property(\"deliveries\").that.is.an(\"array\");\r","});\r","\r","\r","pm.test(\"Each delivery in deliveries array has required properties\", function () {\r","    pm.expect(pm.response.json().deliveries).to.be.an(\"array\").and.to.have.lengthOf.at.least(1);\r","    pm.response.json().deliveries.forEach(function(delivery) {\r","        pm.expect(delivery).to.have.property(\"deliveryId\");\r","        pm.expect(delivery).to.have.property(\"productId\");\r","        pm.expect(delivery).to.have.property(\"trackingId\");\r","        pm.expect(delivery).to.have.property(\"pickupDay\");\r","        pm.expect(delivery).to.have.property(\"pickupCode\");\r","    });\r","});\r","\r",""],"type":"text/javascript"}}],"id":"729f3443-aa4e-4d11-834d-db8e73c1d949","protocolProfileBehavior":{"disableBodyPruning":true},"request":{"auth":{"type":"oauth2","oauth2":[{"key":"addTokenTo","value":"header","type":"string"}]},"method":"GET","header":[{"key":"trackingId","value":"","type":"text"}],"url":{"raw":"{{base_url}}/shipment/:{{tracking_ID}}","host":["{{base_url}}"],"path":["shipment",":{{tracking_ID}}"],"variable":[{"key":"{{tracking_ID}}","value":""}]}},"response":[]}]}